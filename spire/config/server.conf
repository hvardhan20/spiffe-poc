server {
  bind_address = "0.0.0.0"
  bind_port = "8081"

  # SPIFFE trust domain "company.internal" => SPIFFE IDs look like spiffe://company.internal/...
  trust_domain = "company.internal"

  data_dir = "/spire/data"
  log_level = "INFO"
}

plugins {
  DataStore "sql" {
    plugin_data {
      database_type = "postgres"
      connection_string = "dbname=spire user=spire password=spire_pw_change_me host=spire-postgres port=5432 sslmode=disable"
    }
  }

  # PoC-only: simplest. Keys reset on restart. For a more stable PoC, choose a persistent key manager later.
  KeyManager "memory" {
    plugin_data {}
  }

  # PoC: quickest way to onboard SPIRE Agents.
  NodeAttestor "join_token" {
    plugin_data {}
  }
}
